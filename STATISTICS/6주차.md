# 통계학 6주차 정규과제

📌통계학 정규과제는 매주 정해진 분량의 『*데이터 분석가가 반드시 알아야 할 모든 것*』 을 읽고 학습하는 것입니다. 이번 주는 아래의 **Statistics_6th_TIL**에 나열된 분량을 읽고 `학습 목표`에 맞게 공부하시면 됩니다.

아래의 문제를 풀어보며 학습 내용을 점검하세요. 문제를 해결하는 과정에서 개념을 스스로 정리하고, 필요한 경우 추가자료와 교재를 다시 참고하여 보완하는 것이 좋습니다.

6주차는 `3부. 데이터 분석하기`를 읽고 새롭게 배운 내용을 정리해주시면 됩니다.


## Statistics_6th_TIL

### 3부. 데이터 분석하기
### 12.통계 기반 분석 방법론



## Study Schedule

|주차 | 공부 범위     | 완료 여부 |
|----|----------------|----------|
|1주차| 1부 p.2~56     | ✅      |
|2주차| 1부 p.57~79    | ✅      | 
|3주차| 2부 p.82~120   | ✅      | 
|4주차| 2부 p.121~202  | ✅      | 
|5주차| 2부 p.203~254  | ✅      | 
|6주차| 3부 p.300~356  | ✅      | 
|7주차| 3부 p.357~615  | 🍽️      |

<!-- 여기까진 그대로 둬 주세요-->

# 12.통계 기반 분석 방법론

```
✅ 학습 목표 :
* 주성분 분석(PCA)의 개념을 설명할 수 있다.
* 다중공선성을 진단할 수 있다.
* Z-TEST와 T-TEST의 개념을 비교하고, 적절한 상황에서 검정을 설계하고 수행할 수 있다.
* ANOVA TEST를 활용하여 세 개 이상의 그룹 간 평균 차이를 검정하고, 사후검정을 수행할 수 있다.
* 카이제곱 검정을 통해 범주형 변수 간의 독립성과 연관성을 분석하는 방법을 설명할 수 있다.
```

## 12.1. 분석 모델 개요
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->

🔠 __주요 데이터 분석 방법론__
- 통계 모델
    - 통계학 기반
    - 모형과 해석 중시
    - 오차와 불확정성 강조
![4](../STATISTICS/imgstat/image%20copy%2059.png)
- 기계 학습
    - 인공지능에서 파생
    - 대용량 데이터 활용한 예측 정확도 향상 중시 
![2](../STATISTICS/imgstat/image%20copy%2058.png)  

-> 기계학습과 통계모델을 함께 활용하는 것이 좋음

🔷 __기계 학습__   
![1](../STATISTICS/imgstat/image%20copy%2057.png)
- 종속변수의 유무
    - 지도학습
    - 비지도학습 or 강화학습


✏️ __지도학습__   
: 입력에 대한 정답이 주어져 출력된 결괏값과 정답 사이의 오차가 줄어들도록 학습과 모델 수정 반복
- 결괏값이 `양적 척도` → __회귀__
- 결괏값이 `질적 척도` → __분류__

✏️ __비지도학습(자율학습)__   
: 별도의 정답이 없이 변수 간의 패턴을 파악하거나 데이터를 군집화하는 방법   
- `차원 축소`: 주로 지도학습을 할 때 학습 성능을 높이기 위한 전처리 방법으로 사용되는 경우가 많음
- `군집 분석`: 정답지 없이 유사한 관측치들끼리 군집으로 분류하는 기법
- `연관규칙 분석`: 각 소비자의 구매 리스트를 통해 제품 간의 연관성을 수치화하여, 소비자가 앞으로 구매할 가능성이 높은 제품이나 콘텐츠를 추천하기 위해 사용

✏️ __강화학습__    
: 동물이 시행착오를 통해 학습하는 과정을 기본 콘셉트로 한 방법 중 하나. 모델의 결과에 보상과 벌을 주면서 스스로 학습하게 하는 것 


## 12.2. 주성분 분석(PCA)
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->

🔷 __주성분 분석(PCA)__   
: 여러 개의 독립변수들을 잘 설명해 줄 수 있는 주된 성분을 추출하는 기법
- 전체 변수들의 핵심 특성만 선별 → __독립변수(차원)의 수 감소__(차원의 저주 방지)    
⇒ 모형을 간단하게 만들고 분석 결과를 보다 효과적으로 해석

💡 __조건__
- 변수들이 모두 등간 척도나 비율척도로 측정한 `양적변수`
- 관측치들이 서로 `독립`,`정규분포` 구성

🔠 __차원 축소 방법__
1. 변수 선택을 통해 비교적 불필요하거나 유의성이 낮은 변수를 제거
2. 변수들의 잠재적인 성분을 추출하여 차원 축소 → `PCA`, `CFA`
- PCA: 변수의 수를 축약하면서 정보의 손실을 최소화하고자 할 때 사용
- CFA: 변수들 사이에 존재하는 차원을 규명함으로써 변수들 간의 구조 파악

💡 __PCA의 개념__    
- 데이터 공간에 위치하는 점들의 분산을 최대한 보존하는 축을 통해 차원을 축소하는 것이 핵심
- 일반적으로 제1주성분, 제2주성분만으로 대부분의 설명력이 포함되기 때문에 두 개의 주성분만 선정

💡 __PCA의 설명력__   
: 전체 분산 중에서 해당 주성분이 갖고 있는 분산 (	각 주성분이 원래 데이터의 분산(정보량)을 얼마나 보존했는지)
1. 가장 많은 분산을 담아내는 축 도출 → 제1주성분
2. 제1주성분과 직교하는 축 도출 → 제2주성분    

- 주성분 하나의 설명력

$\text{Explained Variance Ratio}_i = \frac{\lambda_i}{\sum_{j=1}^{k} \lambda_j}$

ex) 제1주성분 분산:15, 제2주성분 분산:5 → 제1주성분 설명력 75%, 제2주성분 설명력 25%

## 12.3 공통요인분석(CFA)
✏️ __요인분석__   
: 주어진 데이터의 요인을 분석
- PCA: `전체 분산` 토대로 요인 추출
- CFA: `공통분산`만 토대로 요인 추출 → 공통분산을 가진 변수들이 많을 때 유용하게 사용

1. 탐색적 요인분석: 변수와 요인 간의 관계가 사전에 정립되지 않거나 체화되지 않은 상태에서 변수 간 관계 파악
2. 확인적 요인분석: 이미 변수들의 속성을 예상하고 있는 상태에서 실제로 구조가 그러한지 파악

✏️ __요인분석 방법__   
- 독립변수들 간의 상관성이 요인분석에 적합한지 검증 (바틀렛 테스트, KMO 검정)
- 변수 그룹 간의 상관관계가 각각 다른지 확인  
- 요인분석을 통해 생성되는 주성분 변수들의 고유치 확인 후 요인 개수 결정
- 요인 적재 값 통해 각 변수와 요인 간의 상관관계 정도 확인


   



## 12.4. 다중공선성 해결과 섀플리 밸류 분석
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->

✏️ __다중공선성__   
: 독립변수들 간의 상관관계가 높은 현상 (두 개 이상의 독립변수가 서로 선형적 관계를 나타냄)

- 다중공선성 발생 시 `독립 변수들 간 서로 독립`이라는 회귀분석의 전제 가정 위반 → 추정치의 통계적 유의성 저하로 모델 정합성 맞지 않음

💡 __다중공선성 판별 기준__
1. 회귀 분석 모델 실행 전 상관분석 통해 독립 변수 간 높은 상관계수 갖는 독립변수 도출
2. 결정계수 $R^2$값은 크지만 회귀계수에 대한 t값(t-value)가 낮은 경우 다중공선성 의심
3. VIF(분산팽창계수) 통해 다중공선성 판단 $$VIF_j = \frac{1}{1 - R_j^2}$$

💡 __다중공선성 해결 방법__
1. VIF값이 높은 변수들 중 종속변수와의 상관성(설명력)이 가장 낮은 변수 제거 후 다시 VIF 값 확인 반복
2. 표본 관측치 추가 확보 통한 다중공선성 완화
3. 로그, 표준화 등을 통한 변수 가공
4. 주성분분석 통한 변수 축약
5. 변수 선택 알고리즘 활용하여 적정 변수 자동 선정

✏️ __섀플리 밸류__   
: 각 독립변수가 종속변수의 설명력에 기여하는 순수한 수치를 계산하는 방법
$$Importance_i = \frac{\sum_{n=1}^{N} |\phi_{i}^{(n)}|}{\sum_{j=1}^{p} \sum_{n=1}^{N} |\phi_{j}^{(n)}|}$$
→ 모든 조합에서의 기여도 평균을 구하면 된다


## 12.6. Z-test와 T-test
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->
✏️ __Z-test와 T-test__   
: 단일 표본 집단의 평균 변화를 분석하거나 두 집단의 평균값 혹은 비율 차이를 분석할 때 사용하는 검정 기법 
- 분석하고자 하는 변수가 양적 변수이며, 정규 분포이며, 등분산이라는 조건이 충족되어야 함
    - 등분산 만족 시 → `equal variance t-test`
    - 등분산 불만족 시 → `Welch's t-test`
- 모집단의 분산을 알 수 있는지와 표본의 크기에 따라 Z-test/T-test 선택
    - 모집단 분산 알 수 있는 경우, 표본 크기가 30 이상이여서 정규분포 따르는 경우 → `Z-test`
    - 표본 크기가 30 미만이여서 정규분포 가정할 수 없을 때도 사용 가능 → `T-test`

![4](../STATISTICS/imgstat/image%20copy%2059.png)

🔠 __T-test, Z-test 사용 경우__

1️⃣ T-test
- 단일 집단 평균값 차이
- 두 집단 평균 차이
- 단일 집단 비율 차이

2️⃣ Z-test
- 단일 집단 평균값 차이
- 두 집단 평균 차이
- 두 집단 비율 차이

## 12.7. ANOVA
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->

✏️ __ANOVA__   
: 세 집단 이상의 평균 차이를 검정하는 방법 (분산 분석)
- F분포 사용 (두 모분산의 비교 및 검정)
- F검정의 통곗값은 집단 간 분산의 비율을 나타냄

![5](../STATISTICS/imgstat/image%20copy%2061.png)


💡 __ANOVA의 일반적인 가설__
- $H_0$(귀무가설): 독립변수(인자)의 차이에 따른 종속변수(특성 값)는 동일하다
- $H_1$(대립가설): 독립변수(인자)의 차이에 따른 종속변수(특성 값)는 다르다

🔠 __ANOVA의 분류__
- 요인이 하나인 경우 → 일원 분산분석
- 요인이 두가지라면 → 이원 분산분석
- 요인이 N가지라면 → N원 분산분석

🔢 __ANOVA의 조건__
- 독립변수: 범주(분류)형 변수
- 종속변수: 연속형 변수
- 독립변수와 종속변수가 연속형일 떼 → 회귀분석
- 독립변수와 종속변수가 분류형일 때 → 교차분석

- `집단 내 분산`: 집단 내 각 관측치들이 집단 평균으로부터 얼마나 퍼져 있는지를 나타냄
- `집단 간 평균의 분산`: 전체 집단의 통합 평균과 각 집단의 평균값이 얼마나 퍼져있는지

![6](../STATISTICS/imgstat/image%20copy%2062.png)

$$F = \frac{\sum_{i=1}^{k} n_i (\bar{X}_i - \bar{X})^2 / (k - 1)}{\sum_{i=1}^{k} \sum_{j=1}^{n_i} (X_{ij} - \bar{X}_i)^2 / (N - k)}$$
→ 집단 간 분산을 집단 내 분산으로 나눠서 F값 도출

![7](../STATISTICS/imgstat/image%20copy%2063.png)
ANOVA 공식 표 통해 제곱합이 제대로 구해졌는지 확인 가능




## 12.8. 카이제곱 검정(교차분석)
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->

✏️ __카이제곱 검정(교차분석)__   
: 명목 혹은 서열척도와 같은 범주형 변수들 간의 연관성을 분석하기 위해 결합분포 활용 방법  
💡 '연령'과 같은 비율 척도 변수 → '연령대'와 같은 `서열척도`로 변환 필요   
- 변수들간의 범주를 동시에 교차하는 교차표로 각각의 빈도와 비율을 통해 변수 상호 간의 독립성, 관련성 분석
- 상관분석과 달리 연관성 수치로 표현 x → 카이 제곱 통해 연관성이 없다는 귀무가설 기각 여부로 판단

![8](../STATISTICS/imgstat/image%20copy%2064.png)

기대빈도 조합표를 이용해 기대빈도를 구할 수 있음
→ 이를 통해 검정통계량 $x^2$ 값 산출하여 유의수준에 따라 결정된 임계치 비교하여 가설 검정





<br>
<br>

# 확인 문제

### **문제 1.**
> **🧚 경희는 다트비 교육 연구소의 연구원이다. 경희는 이번에 새롭게 개발한 교육 프로그램이 기존 프로그램보다 학습 성취도 향상에 효과적인지 검증하고자 100명의 학생을 무작위로 두 그룹으로 나누어 한 그룹(A)은 새로운 교육 프로그램을, 다른 그룹(B)은 기존 교육 프로그램을 수강하도록 하였다. 실험을 시작하기 전, 두 그룹(A, B)의 초기 시험 점수 평균을 비교한 결과, 유의미한 차이가 없었다. 8주 후, 학생들의 최종 시험 점수를 수집하여 두 그룹 간 평균 점수를 비교하려고 한다.**   

> **🔍 Q1. 이 실험에서 사용할 적절한 검정 방법은 무엇인가요?**

```
독립표본 t-test를 시행해야 한다. 두 그룹이 서로 독립이고, 연속형 변수의 평균 차이를 비교하기 때문이다.
```

> **🔍 Q2. 이 실험에서 설정해야 할 귀무가설과 대립가설을 각각 작성하세요.**

```
귀무가설: 두 프로그램 간의 시험 점수 평균에 차이가 없다.
대립가설: 두 프로그램 간의 시험 점수 평균에 차이가 있다.
```

> **🔍 Q3. 검정을 수행하기 위한 절차를 순서대로 서술하세요.**

<!--P.337의 실습 코드 흐름을 확인하여 데이터를 불러온 후부터 어떤 절차로 검정을 수행해야 하는지 고민해보세요.-->

```python
# 데이터 확인
df.head()
df.describe()

# A, B 그룹 박스플롯 시각화
df =  pd.melt(df)
plt.figure(figsize=(12,6))
sns.boxplot(x='variable', y='value', data=df2)
plt.title('교육 프로그램 비교')
plt.show()

# 정규성 검정 (Shapiro-Wilk Test)
print("Shapiro Test - Group A:", shapiro(df['group_A']))
print("Shapiro Test - Group B:", shapiro(df['group_B']))

# 등분산성 검정 (Bartlett Test)
print("Bartlett Test:", bartlett(df['group_A'], df['group_B']))

# 독립표본 t-검정
ttest_ind(df['group_A'], df['group_B'], equal_var=False)
```

> **🔍 Q4. 이 검정을 수행할 때 가정해야 하는 통계적 조건을 설명하세요.**

```
독립성, 정규성, 등분산성
```

> **🔍 Q5. 추가적으로 최신 AI 기반 교육 프로그램(C)도 도입하여 기존 프로그램(B) 및 새로운 프로그램(A)과 비교하여 성취도 차이가 있는지 평가하고자 한다면 어떤 검정 방법을 사용해야 하나요? 단, 실험을 시작하기 전, C 그룹의 초기 점수 평균도 A, B 그룹과 유의미한 차이가 없었다고 가정한다.**

```
ANOVA 검정을 시행해야 한다. 세 집단 간의 비교이기 때문이다. 
```

> **🔍 Q6. 5번에서 답한 검정을 수행한 결과, 유의미한 차이가 나타났다면 추가적으로 어떤 검정을 수행해 볼 수 있을까요?**

```
사후 검증을 시행한다. 1종 오류를 방지할 수 있다. 
```

---

### **문제 2. 카이제곱 검정**  
> **🧚 다음 중 어떠한 경우에 카이제곱 검정을 사용해야 하나요?   
1️⃣ 제품 A, B, C의 평균 매출 차이를 비교하고자 한다.  
2️⃣ 남성과 여성의 신체 건강 점수 평균 차이를 분석한다.  
3️⃣ 제품 구매 여부(구매/미구매)와 고객의 연령대(10대, 20대, 30대…) 간의 연관성을 분석한다.  
4️⃣ 특정 치료법이 환자의 혈압을 감소시키는 효과가 있는지 확인한다.**  

```
3️⃣, 카이제곱 검정은 범주형 변수 간 관계를 분석할 때 사용한다.